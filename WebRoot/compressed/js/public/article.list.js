$(function(){function t(){p.removeClass("curr"),f.hide();var t=v[location.hash.substr(1)],l=p[t];if($(l).addClass("curr"),k.text($(l).text().replace(/\s+/g,"").replace(">>","")),"curr"!=l.className){var o=l.className.split(" ")[0]+"-layer",s=$("#leftNavMenu>li."+o);s.hasClass("active")||s[0].click()}return x.length>0&&(x.removeClass("active"),x[t].className="list active"),r=l.getAttribute("data-article-type"),"note"==r&&d.width()>414&&f.show(),r?i(0,1,P[r]):(r=l.getAttribute("data-article-id"))?n(r,t):(r=l.getAttribute("data-subject"))?a(t):(r=l.getAttribute("data-economic-type"))?e(t):(r=l.getAttribute("data-map"),r?c():void 0)}function e(t){var e=$(x[t]).children().eq(0);if(""==e.html()){for(var a,n,i=(new Date).getFullYear(),l="",c=0==t?"全市主要经济指标":"各县主要经济指标",o=0==t?"cityEconomicIndexDetail.html":"countyEconomicIndexDetail.html",r=0;5>r;r++){for(l+="<tr class='"+(r%2==0?"even":"odd")+"'>                <th>"+(i-r)+"年"+c+"</th>",a=2;13>a;a++)n=10>a?"0"+a:a,l+="<td><a href='"+o+"?time="+(i-r)+n+"'>"+n+"月</a></td>";l+="</tr>"}e.html(l)}}function a(t){$.get("/subjectServlet",{opeType:"queryAll",refresh:Math.random()},function(e,a){if("success"==a){var n,i="";for(o=0;o<e.data.length;o++)n=e.data[o],i+="1"==n.isOutLink?'<li><a href="'+n.outLink+'" title="'+n.subjectName+'">'+n.subjectName+"</a></li>":'<li><a href="subject.html?id='+n.id+"&name="+encodeURIComponent(n.subjectName)+'" title="'+n.subjectName+'">'+n.subjectName+"</a></li>";$(x[t]).children().eq(0).html(i)}},"json")}function n(t,e){$.get("articleServlet",{opeType:"queryArticleById",id:t},function(t){x[e].innerHTML=t.content},"json")}function i(t,e,a){var n,i="";"note"==a.category?$.get("/noteBookServlet",{opeType:"queryAll",start:t,length:b,isPublish:1,refresh:(new Date).getTime()},function(t,c){if("success"==c){for(n=0;n<t.data.length;n++)i+='<li><a href="consult.html?id='+t.data[n].id+'" title="'+t.data[n].noteTitle+'">'+t.data[n].noteTitle+"</a><span>"+t.data[n].createTime.slice(0,-3)+"</span></li>";a.listContainer.html(i),l(t,a,e)}},"json"):$.get("/articleServlet",{opeType:"queryArticleListByCategory",category:a.category,searchKeyWords:"",start:t,length:b,lineWordsNum:400,isPublic:"1",refresh:(new Date).getTime()},function(t,c){if("success"==c){for(n=0;n<t.data.length;n++)i+='<li><a href="article.html?id='+t.data[n].id+'" title="'+t.data[n].title+'">'+t.data[n].title+"</a><span>"+t.data[n].publishTime.slice(0,-3)+"</span></li>";a.listContainer.html(i),l(t,a,e)}},"json")}function l(t,e,a){var n=parseInt(t.recordsTotal/b,10);t.recordsTotal%b!=0&&(n+=1),e.totalPageInput.val(n),e.currPageInput.val(a),e.currPageNumInput.val(t.data.length),0==t.recordsTotal?(e.firstPageLink.hide(),e.prevPageLink.hide(),e.nextPageLink.hide(),e.lastPageLink.hide()):(e.totalPageSpan.text(n),e.totalRecordSpan.text(t.recordsTotal),e.currPageSpan.text(a),1==a?(e.firstPageLink.hide(),e.prevPageLink.hide()):(e.firstPageLink.show(),e.prevPageLink.show()),a==n?(e.nextPageLink.hide(),e.lastPageLink.hide()):(e.nextPageLink.show(),e.lastPageLink.show()))}function c(){function t(){n=ls("mapData_"+r),n?e(JSON.parse(n)):a.search(o[r].name,function(t,a){"complete"==t&&(n=a.districtList[0].boundaries,n&&ls("mapData_"+r,JSON.stringify(n)),e(n))})}function e(e){i=new AMap.Polygon({map:l,strokeWeight:.5,path:e,fillOpacity:.1,fillColor:"#000000",strokeColor:"#428bca",strokeOpacity:.5,extData:{name:o[r].name,link:o[r].link}}),AMap.event.addListener(i,"click",function(){window.open(this.getExtData().link)}),AMap.event.addListener(i,"mouseover",function(t){this.setOptions({strokeColor:"#17579d",fillOpacity:.3}),c.text(this.getExtData().name).show()}),AMap.event.addListener(i,"mouseout",function(t){this.setOptions({strokeColor:"#428bca",fillOpacity:.1}),c.hide()}),r++,r<o.length?t():l.setZoom(7.5)}if(""==$("#mapContainer").html()){var a,n,i,l=new AMap.Map("mapContainer",{zoom:6.5,resizeEnable:!0,center:[115.200278,25.85097]}),c=$("#mapInfo"),o=[{name:"章贡区",link:"http://xxgk.zgq.gov.cn/bmgkxx/tjj"},{name:"赣县",link:"http://xxgk.ganxian.gov.cn/bmgkxx/tjj"},{name:"信丰县",link:"http://xxgk.jxxf.gov.cn/bmgkxx/zhbm/xtjj"},{name:"大余县",link:"http://xxgk.jxdy.gov.cn/cms/admin/common/testcontent4.action?channelId=9472"},{name:"南康区",link:"http://xxgk.nkjx.gov.cn/bmgkxx/tjj"},{name:"上犹县",link:"http://xxgk.shangyou.gov.cn/bmgkxx/tjj"},{name:"崇义县",link:"http://xxgk.chongyi.gov.cn/bmgkxx/tjj"},{name:"安远县",link:"http://xxgk.ay.gov.cn/bmgkxx/tjj"},{name:"龙南县",link:"http://xxgk.jxln.gov.cn/bmgkxx/tjj"},{name:"定南县",link:"http://xxgk.dingnan.gov.cn/bmgkxx/tjj"},{name:"全南县",link:"http://xxgk.quannan.gov.cn/bmgkxx/tjj"},{name:"宁都县",link:"http://xxgk.ningdu.gov.cn/bmgkxx/xtjj"},{name:"于都县",link:"http://xxgk.yudu.gov.cn/bmgkxx/xtjj"},{name:"兴国县",link:"http://xxgk.xingguo.gov.cn/bmgkxx/tjj"},{name:"会昌县",link:"http://xxgk.huichang.gov.cn/bmgkxx/xtjj"},{name:"寻乌县",link:"http://xxgk.xunwu.gov.cn/bmgkxx/xtjj/gkxx/jgzn"},{name:"石城县",link:"http://xxgk.shicheng.gov.cn/bmgkxx/xtjj"},{name:"瑞金市",link:"http://xxgk.ruijin.gov.cn/bmgkxx/tjj"}],r=0;AMap.service("AMap.DistrictSearch",function(){a=new AMap.DistrictSearch({level:"district",extensions:"all",subdistrict:0}),t()})}}var o,r,s,u,h,g,d=$(window),v={},p=$("#leftNavMenu>li[data-nav]"),m=$("#leftNavMenu>li[data-layer]"),x=$("#articleContent>div.list"),k=$("div.content>div.currPos>a.curr"),f=$("#consultBtn"),j=$("#consultWrap"),b=20,P={};for(o=0;o<p.length;o++)r=p[o].getAttribute("data-article-type"),s=p[o].getAttribute("data-nav"),v[s]=o,0==o&&(u=s),r&&(h=$(x[o]),g=h.children("div"),P[r]={category:r,listContainer:h.children("ul"),totalPageInput:g.children("input.totalPage"),currPageInput:g.children("input.currPage"),currPageNumInput:g.children("input.currPageNum"),totalPageSpan:g.children("span").children("span.totalPage"),totalRecordSpan:g.children("span").children("span.totalRecord"),currPageSpan:g.children("span").children("span.currPage"),firstPageLink:g.children("a.first"),prevPageLink:g.children("a.prev"),nextPageLink:g.children("a.next"),lastPageLink:g.children("a.last")});if(m.click(function(){var t=$(this),e=this.getAttribute("data-layer"),a=$("#leftNavMenu>li."+e);a.is(":visible")?(a.hide(),t.removeClass("active")):(a.show(),t.addClass("active"))}),$("#articleContent>div.list>div>a.first").click(function(){var t=$(this).parent(),e=t.attr("data-article-type"),a=P[e];if(a){var n=a.currPageInput.val()-0;n>1&&i(0,1,a)}}),$("#articleContent>div.list>div>a.prev").click(function(){var t=$(this).parent(),e=t.attr("data-article-type"),a=P[e];if(a){var n=a.currPageInput.val()-0,l=a.currPageNumInput.val()-0;n>1&&i((n-2)*l,n-1,a)}}),$("#articleContent>div.list>div>a.next").click(function(){var t=$(this).parent(),e=t.attr("data-article-type"),a=P[e];if(a){var n=a.currPageInput.val()-0,l=a.totalPageInput.val()-0,c=a.currPageNumInput.val()-0;l>n&&i(n*c,n+1,a)}}),$("#articleContent>div.list>div>a.last").click(function(){var t=$(this).parent(),e=t.attr("data-article-type"),a=P[e];if(a){var n=a.currPageInput.val()-0,l=a.totalPageInput.val()-0,c=a.currPageNumInput.val()-0;l>n&&i((l-1)*c,l,a)}}),p.click(function(){"curr"!=this.className&&(location.hash=this.getAttribute("data-nav"))}),window.onhashchange=function(){location.hash&&void 0!=v[location.hash.substr(1)]||(location.hash=u),t()},location.hash&&void 0!=v[location.hash.substr(1)]?t():location.hash=u,j[0]){var y=$("#consult-name"),w=$("#consult-email"),C=$("#consult-title"),N=$("#consult-content"),A=$("#consultWrap>div>div.spec");f.click(function(){y.val(""),w.val(""),C.val(""),N.val(""),j.show(),setTimeout(function(){j.addClass("active"),j.children("div").addClass("active")},100)}),A.on("click","i",function(){"active"!=this.className&&(A.children("i").removeClass("active"),this.className="active")}),$("#consult-name,#consult-email,#consult-title,#consult-content").on("input",function(){var t=$(this),e=t.attr("maxlength");t.val().length>e&&t.val(t.val().substr(0,e))}),$("#consultWrap>div>h4>a.close").click(function(){j.removeClass("active"),j.children("div").removeClass("active"),setTimeout(function(){j.hide()},500)}),$("#consultWrap>div>h4>a.submit").click(function(){return 0==y.val().length?(tipShow("请输入您的姓名！",1e3),void y[0].focus()):0==w.val().length||/^([\.a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(\.[a-zA-Z0-9_-])+/.test(w.val())?0==C.val().length?(tipShow("请输入留言标题！",1e3),void C[0].focus()):0==N.val().length?(tipShow("请输入留言内容！",1e3),void N[0].focus()):void $.post("/noteBookServlet",{opeType:"saveNoteBook",name:y.val(),email:w.val(),sex:$("#consultWrap>div>div.spec>i.active").attr("data-label"),noteTitle:C.val(),noteContent:N.val()},function(t,e){"success"==e&&1==t?(tipShow("您的留言提交成功，请等待后台审核."),$("#consultWrap>div>h4>a.close")[0].click()):tipShow("您的留言提交失败，请稍后重试.")}):(tipShow("请输入正确的电子邮箱！",1e3),void w[0].focus())})}});